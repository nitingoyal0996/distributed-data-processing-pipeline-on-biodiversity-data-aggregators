from pyspark.sql.types import StructType, StructField, StringType

# Define the schema for the JSON-like message
schema = StructType([
    StructField("dwc:startDayOfYear", StringType(), True),
    StructField("dc:language", StringType(), True),
    StructField("dwc:specificEpithet", StringType(), True),
    StructField("dwc:countryCode", StringType(), True),
    StructField("dwc:latestPeriodOrHighestSystem", StringType(), True),
    StructField("dc:type", StringType(), True),
    StructField("dwc:recordedBy", StringType(), True),
    StructField("dwc:informationWithheld", StringType(), True),
    StructField("dwc:georeferencedDate", StringType(), True),
    StructField("dwc:order", StringType(), True),
    StructField("dwc:earliestEonOrLowestEonothem", StringType(), True),
    StructField("dwc:individualCount", StringType(), True),
    StructField("dwc:latestEonOrHighestEonothem", StringType(), True),
    StructField("dwc:group", StringType(), True),
    StructField("dwc:dataGeneralizations", StringType(), True),
    StructField("dwc:earliestEpochOrLowestSeries", StringType(), True),
    StructField("dwc:latestAgeOrHighestStage", StringType(), True),
    StructField("id", StringType(), True),
    StructField("dwc:stateProvince", StringType(), True),
    StructField("dcterms:bibliographicCitation", StringType(), True),
    StructField("dwc:eventDate", StringType(), True),
    StructField("dwc:bed", StringType(), True),
    StructField("dwc:institutionCode", StringType(), True),
    StructField("dwc:country", StringType(), True),
    StructField("dwc:earliestPeriodOrLowestSystem", StringType(), True),
    StructField("dwc:collectionCode", StringType(), True),
    StructField("dwc:occurrenceStatus", StringType(), True),
    StructField("dwc:kingdom", StringType(), True),
    StructField("dwc:decimalLatitude", StringType(), True),
    StructField("dwc:georeferenceVerificationStatus", StringType(), True),
    StructField("dwc:basisOfRecord", StringType(), True),
    StructField("dwc:genus", StringType(), True),
    StructField("dwc:continent", StringType(), True),
    StructField("dwc:family", StringType(), True),
    StructField("dwc:latestEpochOrHighestSeries", StringType(), True),
    StructField("dwc:georeferenceSources", StringType(), True),
    StructField("dwc:higherClassification", StringType(), True),
    StructField("dwc:previousIdentifications", StringType(), True),
    StructField("dcterms:license", StringType(), True),
    StructField("dwc:phylum", StringType(), True),
    StructField("dwc:county", StringType(), True),
    StructField("dwc:locality", StringType(), True),
    StructField("dwc:geodeticDatum", StringType(), True),
    StructField("dwc:taxonRank", StringType(), True),
    StructField("dwc:formation", StringType(), True),
    StructField("dwc:class", StringType(), True),
    StructField("dwc:catalogNumber", StringType(), True),
    StructField("dwc:nomenclaturalCode", StringType(), True),
    StructField("dwc:higherGeography", StringType(), True),
    StructField("dwc:month", StringType(), True),
    StructField("dwc:member", StringType(), True),
    StructField("dwc:coordinateUncertaintyInMeters", StringType(), True),
    StructField("dwc:scientificNameAuthorship", StringType(), True),
    StructField("dwc:endDayOfYear", StringType(), True),
    StructField("dwc:earliestAgeOrLowestStage", StringType(), True),
    StructField("dwc:verbatimLocality", StringType(), True),
    StructField("dwc:verbatimEventDate", StringType(), True),
    StructField("dwc:decimalLongitude", StringType(), True),
    StructField("dwc:latestEraOrHighestErathem", StringType(), True),
    StructField("dwc:earliestEraOrLowestErathem", StringType(), True),
    StructField("dwc:occurrenceID", StringType(), True),
    StructField("dwc:georeferenceProtocol", StringType(), True),
    StructField("dcterms:modified", StringType(), True),
    StructField("dwc:scientificName", StringType(), True),
    StructField("dwc:day", StringType(), True),
    StructField("dwc:year", StringType(), True)
])
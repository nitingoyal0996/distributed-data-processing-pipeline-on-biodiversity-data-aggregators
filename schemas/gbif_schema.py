from pyspark.sql.types import StructType, StructField, StringType, IntegerType, DoubleType, BooleanType, ArrayType, MapType

# Define the schema for the JSON-like message
schema = StructType([
    StructField("key", IntegerType(), True),
    StructField("datasetKey", StringType(), True),
    StructField("publishingOrgKey", StringType(), True),
    StructField("installationKey", StringType(), True),
    StructField("hostingOrganizationKey", StringType(), True),
    StructField("publishingCountry", StringType(), True),
    StructField("protocol", StringType(), True),
    StructField("lastCrawled", StringType(), True),
    StructField("lastParsed", StringType(), True),
    StructField("crawlId", IntegerType(), True),
    StructField("extensions", MapType(StringType(), StringType()), True),
    StructField("basisOfRecord", StringType(), True),
    StructField("occurrenceStatus", StringType(), True),
    StructField("taxonKey", IntegerType(), True),
    StructField("kingdomKey", IntegerType(), True),
    StructField("phylumKey", IntegerType(), True),
    StructField("classKey", IntegerType(), True),
    StructField("orderKey", IntegerType(), True),
    StructField("familyKey", IntegerType(), True),
    StructField("genusKey", IntegerType(), True),
    StructField("speciesKey", IntegerType(), True),
    StructField("acceptedTaxonKey", IntegerType(), True),
    StructField("scientificName", StringType(), True),
    StructField("acceptedScientificName", StringType(), True),
    StructField("kingdom", StringType(), True),
    StructField("phylum", StringType(), True),
    StructField("order", StringType(), True),
    StructField("family", StringType(), True),
    StructField("genus", StringType(), True),
    StructField("species", StringType(), True),
    StructField("genericName", StringType(), True),
    StructField("specificEpithet", StringType(), True),
    StructField("taxonRank", StringType(), True),
    StructField("taxonomicStatus", StringType(), True),
    StructField("iucnRedListCategory", StringType(), True),
    StructField("decimalLatitude", DoubleType(), True),
    StructField("decimalLongitude", DoubleType(), True),
    StructField("elevation", DoubleType(), True),
    StructField("elevationAccuracy", DoubleType(), True),
    StructField("continent", StringType(), True),
    StructField("gadm", MapType(StringType(), StructType([
        StructField("gid", StringType(), True),
        StructField("name", StringType(), True)
    ])), True),
    StructField("year", IntegerType(), True),
    StructField("month", IntegerType(), True),
    StructField("day", IntegerType(), True),
    StructField("eventDate", StringType(), True),
    StructField("startDayOfYear", IntegerType(), True),
    StructField("endDayOfYear", IntegerType(), True),
    StructField("issues", ArrayType(StringType()), True),
    StructField("lastInterpreted", StringType(), True),
    StructField("license", StringType(), True),
    StructField("isSequenced", BooleanType(), True),
    StructField("identifiers", ArrayType(StructType([
        StructField("identifier", StringType(), True)
    ])), True),
    StructField("media", ArrayType(StringType()), True),
    StructField("facts", ArrayType(StringType()), True),
    StructField("relations", ArrayType(StringType()), True),
    StructField("isInCluster", BooleanType(), True),
    StructField("datasetID", StringType(), True),
    StructField("recordedBy", StringType(), True),
    StructField("identifiedBy", StringType(), True),
    StructField("geodeticDatum", StringType(), True),
    StructField("class", StringType(), True),
    StructField("countryCode", StringType(), True),
    StructField("recordedByIDs", ArrayType(StringType()), True),
    StructField("identifiedByIDs", ArrayType(StringType()), True),
    StructField("gbifRegion", StringType(), True),
    StructField("country", StringType(), True),
    StructField("publishedByGbifRegion", StringType(), True),
    StructField("identifier", StringType(), True),
    StructField("eventID", StringType(), True),
    StructField("http://unknown.org/language", StringType(), True),
    StructField("footprintWKT", StringType(), True),
    StructField("originalNameUsage", StringType(), True),
    StructField("municipality", StringType(), True),
    StructField("county", StringType(), True),
    StructField("identificationVerificationStatus", StringType(), True),
    StructField("nameAccordingTo", StringType(), True),
    StructField("gbifID", StringType(), True),
    StructField("occurrenceID", StringType(), True),
    StructField("taxonID", StringType(), True)
])